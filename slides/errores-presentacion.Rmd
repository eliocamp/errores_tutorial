---
title: "Conquistando errores con R"
author: "Pao Corrales"
institute: "LatinR 2022"
date: "11 de octubre de 2022"
output:
  xaringan::moon_reader:
    css: [default, "verde.css", default-fonts]
    lib_dir: libs
    nature:
      highlightStyle: solarized-light
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'
---

class: center


```{r meta, echo=FALSE}
library(metathis)
meta() %>%
  meta_general(
    description = "Tutorial de debugging creado para LatinR 2022",
    generator = "xaringan and remark.js"
  ) %>% 
  meta_name("github-repo" = "paocorrales/errores_tutorial") %>% 
  meta_social(
    title = "Conquistando errores con R",
    url = "https://paocorrales.github.io/errores_tutorial/slides/errores-presentacion.html",
    image = "https://paocorrales.github.io/errores_tutorial/slides/img/ladybug.png",
    image_alt = "Tutorial Conquistando errores con R",
    og_type = "website",
    og_author = "Pao Corrales",
    twitter_card_type = "summary_large_image",
    twitter_creator = "@paobcorrales"
  )
```

```{r xaringan-extra-styles, include=FALSE}
library(countdown)
library(datos)
library(dplyr)
library(tidyr)

xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,       
  mute_unhighlighted_code = TRUE
)
```

## Hola!

```{r echo=FALSE, message=FALSE, warning=FALSE, out.width='30%'}
knitr::include_graphics(here::here("slides/img/pao_circle.png"))
```

@paobcorrales

[paocorrales.github.io](https://paocorrales.github.io/)


---

## Mapa de ruta


--

* Los mensajes no son errores, los warnings tampoco (a veces)

--

* Errores en cadenas de código (team ` %>% ` o `|`)

--

* Errores en código anidado (`mean(sd(random(n)))`)

--

* Errores en loops y funciones

--

* Qué hacer cuando todo lo anterior no funciona

--

#### Estos materiales

Página web: [paocorrales.github.io/errores_tutorial/](https://paocorrales.github.io/errores_tutorial/)

Estas slides: [paocorrales.github.io/errores_tutorial/slides/errores-presentacion.html](https://paocorrales.github.io/errores_tutorial/slides/errores-presentacion.html)
---

## Interpretando a R

Este es un mensaje:

```{r message=TRUE}
library(data.table)
```
---

## Interpretando a R

Éste es un warning o advertencia:

```{r}
x <- c(1, 3)
y <- c(1, 2, 3, 4, 5)

z <- x == y
```
---

## Interpretando a R

Éste es un error:

```{r, error=TRUE}
date[5]
```
--

&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;

------------------------------------------------------------

R y RStudio necesitan usar distintos colores para mensajes, advertencias y errores. 

Mientras tanto, rojo/naranja no implica necesariamente error!

---

## Antes de continuar... vayamos preparando R

Para trabajar localmente `r emo::ji("computer")`:

Para trabajar en RStudio Cloud `r emo::ji("cloud")`: 

&nbsp;
&nbsp;


`r emo::ji("point_right")` ¿Dudas? ¿Problemas? Escribilos en el chat y te ayudamos!

---

## Errores en cadenas de código

```{r, error=TRUE}
pinguinos %>% 
  mutate(dim_pico = largo_pico_mm + alto_pico_mm) %>% 
  group_by(especie, sexo) %>% 
  summarise(pico_promedio = mean(dim_pico)) %>% 
  pivot_wider(names_from = "especie", values_from = c("pico_promdio"))
  
```

* ¿Devuelve un mensaje de error?
  - ¿Qué dice el error? ¿Menciona el número de línea o la función que genera problemas? 
  
* ¿El resultado no es el esperado?
  - ¿La variable (un data.frame?) de entrada tiene la pinta que debería tener?

Si el error no se resuelve, correr las líneas de código de forma incremental suele ayudar.

---

## Errores en código anidado

```{r, error=TRUE}
y <- runif(15)

y[y > max(sample(runif(15), 0))]
```


* ¿Devuelve un mensaje de error?
  - ¿Están todos los paréntesis y corchetes necesarios?

* ¿El resultado no es el esperado?
  - ¿La variable de entrada tiene la pinta que debería tener?

Acá la estrategía es correr el código de adentro hacía afuera y revisar:

* ¿Estoy usando los argumentos correctos en cada función?
* En qué momento da error o el resultado no es correcto.

---

## Errores en funciones y loops

* Puede ser más complejo encontrar el error porque 
  - el código es más complejo
  - el código se corre en bloque, en vez de línea por línea
  
Necetamos algunas herramientas extras para entender el contexto en el que ocurre el error y poder resolverlo. 

---

## ¿Arrancamos?


Si lograste abrir el proyecto de RStudio usá la reacción `r emo::ji("+1")`

Si tuviste algún problema levantá la mano `r emo::ji("raised_hand")`

---

## Ejercicio 1


---
class: center, inverse, middle
background-image: url("img/ladybug.png")
background-size: contain

# Pausa

Aprovechá para levantarte de la silla y estirar un poco!

```{r echo=FALSE}
countdown(minutes = 5, play_sound = TRUE, 
          left = 0, 
          right = 0,
          color_background = "#26a69a",
          color_running_text = "white",
          color_finished_text = "white",
          padding = "50px",
          margin = "5%",
          font_size = "4em")
```


---
## Ejercicio 2

---

## Qué hacer cuando todo lo anterior no funciona

Hay errores testarudos que no se resuelven fácilmente. Otras veces el error está en una función de un paquete y no podemos resolverlo. 

Siempre está google:

* Buscar el error (sin nombres de variables o información específica)
* Hay más opciones en inglés que en español :(

Pero siempre, siempre está la comunidad de R para pedir ayuda:

* En un slack (RLadies, LatinR, R4DS)
* Community de RStudio
* Twitter: #RStats, #RStatES
* StackOverflow

Pero **"Me da un error"** no es suficiente para entender el error y encontrar una solución. Idealmente necesitamos generar un ejemplo que reproduzca el error y podamos compartir. 

---

## Reprex (**re**producible **ex**ample)

* El código debe ser autocontenido.
* Es preferible usar datos que vienen con R o generados sintéticamente.
* Incluí solo lo necesario.
* Respetá la computadora de tus colegas.
* Incluye la salida que genera el código.


### ¿Cómo se usa?

0. Adaptá tu código para que sea reproducible y autocontenido.
1. Copiá el código necesario.
2. Corré `reprex()`.
3. Revisá la salida localmente.
4. Copia todo en GitHub/Slack/etc.
5. Esperá.

Para saber más: [https://speakerdeck.com/jennybc/reprex-reproducible-examples-with-r](https://speakerdeck.com/jennybc/reprex-reproducible-examples-with-r)
---

class: center, inverse, middle
background-image: url("img/ladybug.png")
background-size: contain

# ¿Dudas?